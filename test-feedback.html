<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Feedback Page Test</title>
    <link rel="stylesheet" href="./src/styles/feedback/feedback-page.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <div class="feedback-main">
        <div class="feedback-container">
            <div class="feedback-header">
                <h1><i class="fas fa-comment-dots"></i> Gửi Phản Hồi</h1>
                <p>Chúng tôi luôn lắng nghe ý kiến của bạn để cải thiện dịch vụ</p>
            </div>

            <div class="feedback-content">
                <div class="feedback-form">
                    <div class="form-group">
                        <label for="order_id"><i class="fas fa-receipt"></i> Chọn đơn hàng</label>
                        <select id="order_id" name="order_id" required>
                            <option value="">-- Đang tải đơn hàng... --</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="description"><i class="fas fa-comment-alt"></i> Nội dung phản hồi</label>
                        <textarea id="description" name="description" rows="6" placeholder="Nhập nội dung phản hồi của bạn..." required></textarea>
                    </div>

                    <div class="form-group">
                        <label for="images"><i class="fas fa-images"></i> Hình ảnh đính kèm</label>
                        <div class="image-upload-container">
                            <input type="file" id="images" name="images" accept="image/*" multiple>
                            <div class="upload-placeholder">
                                <i class="fas fa-cloud-upload-alt"></i>
                                <span>Chọn hoặc kéo thả hình ảnh vào đây (tối đa 4 ảnh)</span>
                            </div>
                        </div>
                        <div class="image-preview" id="image-preview"></div>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="btn-submit" onclick="showSelectedFiles()">
                            <i class="fas fa-paper-plane"></i> Kiểm tra số lượng ảnh
                        </button>
                    </div>
                </div>

                <div class="feedback-info">
                    <div class="info-card">
                        <i class="fas fa-clock"></i>
                        <h3>Thời gian phản hồi</h3>
                        <p>Chúng tôi sẽ phản hồi trong vòng 24 giờ làm việc</p>
                    </div>
                    <div class="info-card">
                        <i class="fas fa-shield-alt"></i>
                        <h3>Bảo mật thông tin</h3>
                        <p>Thông tin của bạn được bảo mật tuyệt đối</p>
                    </div>
                    <div class="info-card">
                        <i class="fas fa-headset"></i>
                        <h3>Hỗ trợ 24/7</h3>
                        <p>Hotline: 0963456911</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Simulate the image upload functionality
        document.addEventListener('DOMContentLoaded', function() {
            const imageInput = document.getElementById('images');
            const imagePreview = document.getElementById('image-preview');
            let selectedFiles = [];

            imageInput.addEventListener('change', function(e) {
                const files = Array.from(e.target.files);
                
                // Add new files, but limit to 4 total
                files.forEach(file => {
                    if (file.type.startsWith('image/') && selectedFiles.length < 4) {
                        selectedFiles.push(file);
                    }
                });
                
                // Refresh the preview
                renderImagePreviews();
            });

            // Function to render image previews
            function renderImagePreviews() {
                imagePreview.innerHTML = '';
                
                selectedFiles.forEach((file, index) => {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        const previewItem = document.createElement('div');
                        previewItem.className = 'preview-item';
                        previewItem.innerHTML = `
                            <img src="${e.target.result}" alt="Preview ${index + 1}">
                            <button type="button" class="remove-image" data-index="${index}">
                                <i class="fas fa-times"></i>
                            </button>
                        `;
                        
                        // Add event listener to remove button
                        const removeButton = previewItem.querySelector('.remove-image');
                        removeButton.addEventListener('click', function(e) {
                            e.stopPropagation();
                            // Remove the file from selectedFiles array using the data-index attribute
                            const currentIndex = parseInt(removeButton.getAttribute('data-index'));
                            selectedFiles.splice(currentIndex, 1);
                            
                            // Update the file input value to reflect removed files
                            const dt = new DataTransfer();
                            selectedFiles.forEach(file => dt.items.add(file));
                            imageInput.files = dt.files;
                            
                            // Re-render previews
                            renderImagePreviews();
                        });
                        
                        imagePreview.appendChild(previewItem);
                    };
                    reader.readAsDataURL(file);
                });
                
                // Update the file input to reflect current selected files
                const dt = new DataTransfer();
                selectedFiles.forEach(file => dt.items.add(file));
                imageInput.files = dt.files;
            }

            // Handle drag and drop
            const uploadContainer = document.querySelector('.image-upload-container');
            
            uploadContainer.addEventListener('dragover', function(e) {
                e.preventDefault();
                uploadContainer.classList.add('drag-over');
            });
            
            uploadContainer.addEventListener('dragleave', function() {
                uploadContainer.classList.remove('drag-over');
            });
            
            uploadContainer.addEventListener('drop', function(e) {
                e.preventDefault();
                uploadContainer.classList.remove('drag-over');
                
                const files = Array.from(e.dataTransfer.files).filter(file => file.type.startsWith('image/'));
                
                // Add new files, but limit to 4 total
                files.forEach(file => {
                    if (selectedFiles.length < 4) {
                        selectedFiles.push(file);
                    }
                });
                
                // Refresh the preview
                renderImagePreviews();
            });
        });

        function showSelectedFiles() {
            alert(`Bạn đã chọn ${document.getElementById('images').files.length} ảnh (tối đa 4 ảnh)`);
        }
    </script>
</body>
</html>