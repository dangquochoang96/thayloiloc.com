<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Hotline Page</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="src/styles/hotline/hotline-page.css">
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: Arial, sans-serif;
            background: #f8fafc;
        }
    </style>
</head>
<body>
    <div class="technicians-section">
        <h2><i class="fas fa-users-cog"></i> Kỹ Thuật Viên Hỗ Trợ</h2>
        <div class="technicians-filter">
            <select id="areaFilter" class="area-filter">
                <option value="">Tất cả khu vực</option>
                <option value="hcm">TP. Hồ Chí Minh</option>
                <option value="hanoi">Hà Nội</option>
                <option value="danang">Đà Nẵng</option>
                <option value="cantho">Cần Thơ</option>
            </select>
            <button id="refreshTechnicians" class="refresh-btn">
                <i class="fas fa-sync-alt"></i>
                Làm mới
            </button>
        </div>
        <div id="techniciansLoading" class="loading-spinner" style="display: none;">
            <i class="fas fa-spinner fa-spin"></i>
            <p>Đang tải danh sách kỹ thuật viên...</p>
        </div>
        <div id="techniciansGrid" class="technicians-grid">
            <!-- Danh sách kỹ thuật viên sẽ được load -->
        </div>
    </div>

    <script>
        // Format phone number function
        function formatPhoneNumber(phone) {
            if (!phone) return '';
            const cleaned = phone.replace(/\D/g, '');
            if (cleaned.length === 10) {
                return cleaned.replace(/(\d{4})(\d{3})(\d{3})/, '$1.$2.$3');
            }
            return phone;
        }

        // Load technicians function
        function loadTechnicians(area = '') {
            const loadingEl = document.getElementById('techniciansLoading');
            const gridEl = document.getElementById('techniciansGrid');
            
            if (!loadingEl || !gridEl) return;

            loadingEl.style.display = 'block';
            gridEl.innerHTML = '';

            // Dữ liệu mẫu
            const allTechnicians = [
                {
                    id: 1,
                    name: 'Nguyễn Văn A',
                    phone: '0901234567',
                    area: 'TP. Hồ Chí Minh',
                    status: 'active'
                },
                {
                    id: 2,
                    name: 'Trần Thị B',
                    phone: '0912345678',
                    area: 'Hà Nội',
                    status: 'active'
                },
                {
                    id: 3,
                    name: 'Lê Văn C',
                    phone: '0923456789',
                    area: 'Đà Nẵng',
                    status: 'active'
                },
                {
                    id: 4,
                    name: 'Phạm Thị D',
                    phone: '0934567890',
                    area: 'Cần Thơ',
                    status: 'active'
                },
                {
                    id: 5,
                    name: 'Hoàng Văn E',
                    phone: '0945678901',
                    area: 'TP. Hồ Chí Minh',
                    status: 'active'
                },
                {
                    id: 6,
                    name: 'Võ Thị F',
                    phone: '0956789012',
                    area: 'Hà Nội',
                    status: 'active'
                }
            ];

            // Lọc theo khu vực nếu có
            let technicians = allTechnicians;
            if (area) {
                const areaMap = {
                    'hcm': 'TP. Hồ Chí Minh',
                    'hanoi': 'Hà Nội',
                    'danang': 'Đà Nẵng',
                    'cantho': 'Cần Thơ'
                };
                const areaName = areaMap[area] || area;
                technicians = allTechnicians.filter(tech => 
                    tech.area.toLowerCase().includes(areaName.toLowerCase())
                );
            }

            setTimeout(() => {
                loadingEl.style.display = 'none';

                if (technicians.length === 0) {
                    gridEl.innerHTML = `
                        <div class="no-technicians">
                            <i class="fas fa-user-slash"></i>
                            <p>Không có kỹ thuật viên nào trong khu vực này</p>
                        </div>
                    `;
                    return;
                }

                gridEl.innerHTML = technicians.map(tech => `
                    <div class="technician-card ${tech.status === 'active' ? 'active' : 'inactive'}">
                        <div class="tech-avatar">
                            <i class="fas fa-user-cog"></i>
                        </div>
                        <div class="tech-info">
                            <h3>${tech.name}</h3>
                            <div class="tech-phone-display">
                                <i class="fas fa-phone"></i>
                                <span>${formatPhoneNumber(tech.phone)}</span>
                            </div>
                            <p class="tech-area">
                                <i class="fas fa-map-marker-alt"></i>
                                ${tech.area}
                            </p>
                            <p class="tech-status ${tech.status}">
                                <i class="fas fa-circle"></i>
                                ${tech.status === 'active' ? 'Đang hoạt động' : 'Không hoạt động'}
                            </p>
                        </div>
                        <div class="tech-contact">
                            <div class="tech-actions">
                                <a href="tel:${tech.phone}" class="action-btn call-btn">
                                    <i class="fas fa-phone"></i>
                                    Gọi ngay
                                </a>
                                <a href="sms:${tech.phone}" class="action-btn sms-btn">
                                    <i class="fas fa-sms"></i>
                                    Nhắn tin
                                </a>
                            </div>
                        </div>
                    </div>
                `).join('');
            }, 500);
        }

        // Setup event listeners
        document.addEventListener('DOMContentLoaded', function() {
            const areaFilter = document.getElementById('areaFilter');
            const refreshBtn = document.getElementById('refreshTechnicians');

            if (areaFilter) {
                areaFilter.addEventListener('change', (e) => {
                    loadTechnicians(e.target.value);
                });
            }

            if (refreshBtn) {
                refreshBtn.addEventListener('click', () => {
                    const selectedArea = areaFilter ? areaFilter.value : '';
                    loadTechnicians(selectedArea);
                });
            }

            // Load all technicians by default
            loadTechnicians();
        });
    </script>
</body>
</html>